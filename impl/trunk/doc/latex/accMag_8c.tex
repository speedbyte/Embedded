\hypertarget{accMag_8c}{\section{hal/\+I\+M\+U/acc\+Mag/acc\+Mag.c File Reference}
\label{accMag_8c}\index{hal/\+I\+M\+U/acc\+Mag/acc\+Mag.\+c@{hal/\+I\+M\+U/acc\+Mag/acc\+Mag.\+c}}
}
{\ttfamily \#include \char`\"{}../../\+L\+L\+D\+\_\+\+I\+F/\+L\+L\+D\+\_\+\+I2\+C.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}acc\+Mag.\+h\char`\"{}}\\*
{\ttfamily \#include $<$limits.\+h$>$}\\*
Include dependency graph for acc\+Mag.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{accMag_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structhalAccmag__dataContainer}{hal\+Accmag\+\_\+data\+Container} \hyperlink{accMag_8c_a3914b0d0b4d88f06880b47766f844fc8_a3914b0d0b4d88f06880b47766f844fc8}{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Mag\+Container\+\_\+st} (void)
\begin{DoxyCompactList}\small\item\em Get complete data container (acceleration \& compass) \end{DoxyCompactList}\item 
\hyperlink{structhalAccmag__3dDoubleVector}{hal\+Accmag\+\_\+3d\+Double\+Vector} \hyperlink{accMag_8c_aebfdb7e3d86187e1fecee863424aa3fc_aebfdb7e3d86187e1fecee863424aa3fc}{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Vector\+\_\+st} (void)
\begin{DoxyCompactList}\small\item\em Get current state of acceleration. \end{DoxyCompactList}\item 
\hyperlink{structhalAccmag__3dDoubleVector}{hal\+Accmag\+\_\+3d\+Double\+Vector} \hyperlink{accMag_8c_ad4f25c6a1f31b6eb494243aa0706986a_ad4f25c6a1f31b6eb494243aa0706986a}{g\+\_\+hal\+Accmag\+\_\+get\+Mag\+Vector\+\_\+st} (void)
\begin{DoxyCompactList}\small\item\em Get current state of compass. \end{DoxyCompactList}\item 
unsigned int \hyperlink{accMag_8c_ab936c0ac53ff9ba47a138e841a6ba474_ab936c0ac53ff9ba47a138e841a6ba474}{g\+\_\+hal\+Accmag\+\_\+init\+Sensor\+\_\+bl} (void)
\begin{DoxyCompactList}\small\item\em Initialize sensor. \end{DoxyCompactList}\item 
unsigned int \hyperlink{accMag_8c_ad5f9d3a28348a9889f9afecde79606f6_ad5f9d3a28348a9889f9afecde79606f6}{g\+\_\+hal\+Accmag\+\_\+trigger\+Acc\+Update\+\_\+bl} (void)
\begin{DoxyCompactList}\small\item\em Trigger a new measurement of the accelerometer. \end{DoxyCompactList}\item 
unsigned int \hyperlink{accMag_8c_a98cf3442152a9ae213517936f7b37fe0_a98cf3442152a9ae213517936f7b37fe0}{g\+\_\+hal\+Accmag\+\_\+trigger\+Full\+Update\+\_\+bl} (void)
\begin{DoxyCompactList}\small\item\em Trigger a new measurement of both sensors. \end{DoxyCompactList}\item 
unsigned int \hyperlink{accMag_8c_afdbd4ece113ff4859718b678150d069a_afdbd4ece113ff4859718b678150d069a}{g\+\_\+hal\+Accmag\+\_\+trigger\+Mag\+Update\+\_\+bl} (void)
\begin{DoxyCompactList}\small\item\em Trigger a new measurement of the magnetometer. \end{DoxyCompactList}\item 
static double \hyperlink{accMag_8c_a3f6ef9cd19c5f23888aaca4b1ba34ecc_a3f6ef9cd19c5f23888aaca4b1ba34ecc}{l\+\_\+convert\+Acc\+Raw\+To\+S\+I\+Unit\+\_\+f64} (signed short f\+\_\+raw\+Acc\+Val\+\_\+i16, unsigned char f\+\_\+scaling\+Value\+G\+\_\+ui8)
\begin{DoxyCompactList}\small\item\em Converts raw sensor values of the accelerometer into S\+I unit. \end{DoxyCompactList}\item 
static double \hyperlink{accMag_8c_a1f0866c5afdce148afc09ed1c5a8018f_a1f0866c5afdce148afc09ed1c5a8018f}{l\+\_\+convert\+Mag\+Raw\+To\+S\+I\+Unit\+\_\+f64} (signed short f\+\_\+raw\+Mag\+Val\+\_\+i16, unsigned char f\+\_\+scaling\+Value\+Gauss\+\_\+ui8)
\begin{DoxyCompactList}\small\item\em Converts raw sensor values of the magnetometer into S\+I unit. \end{DoxyCompactList}\item 
static unsigned char \hyperlink{accMag_8c_abaacf0917ab7bbc9b9d13b9aeb31afd1_abaacf0917ab7bbc9b9d13b9aeb31afd1}{l\+\_\+read\+I2c\+Byte\+\_\+ui8} (unsigned char f\+\_\+register\+Addr\+\_\+ui8)
\begin{DoxyCompactList}\small\item\em Wrapper function to read a single byte register of L\+S\+M303\+D. \end{DoxyCompactList}\item 
static unsigned int \hyperlink{accMag_8c_a84dc4f1647051d5c34296705fa1f236b_a84dc4f1647051d5c34296705fa1f236b}{l\+\_\+read\+I2c\+Byte\+Stream\+\_\+bl} (unsigned char f\+\_\+start\+Register\+Addr\+\_\+ui8, const unsigned char $\ast$f\+\_\+read\+Destination\+Buffer\+\_\+pui8, unsigned int f\+\_\+num\+Of\+Bytes\+To\+Read\+\_\+ui32)
\begin{DoxyCompactList}\small\item\em Wrapper function to read byte stream to registers of L\+S\+M303\+D. \end{DoxyCompactList}\item 
static signed short \hyperlink{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{l\+\_\+two\+Comp\+Of16\+Bit\+\_\+ui16} (unsigned char f\+\_\+lsb\+\_\+ui8, unsigned char f\+\_\+msb\+\_\+ui8)
\begin{DoxyCompactList}\small\item\em Complement of twos of a 16 bit integer. \end{DoxyCompactList}\item 
static unsigned int \hyperlink{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b}{l\+\_\+update\+Sensor\+State\+\_\+vd} (\hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8}{hal\+Accmag\+\_\+sensor\+Select} f\+\_\+sensor\+\_\+en)
\begin{DoxyCompactList}\small\item\em Trigger a update of the current sensor state data. \end{DoxyCompactList}\item 
static unsigned int \hyperlink{accMag_8c_af4a867d90abb126d82ba14ea2619f305_af4a867d90abb126d82ba14ea2619f305}{l\+\_\+write\+I2c\+Byte\+Stream\+\_\+bl} (unsigned char f\+\_\+start\+Register\+Addr\+\_\+ui8, const unsigned char $\ast$const f\+\_\+byte\+Stream\+To\+Write\+\_\+pui8, unsigned int f\+\_\+num\+Of\+Bytes\+\_\+ui32)
\begin{DoxyCompactList}\small\item\em Wrapper function to write a single byte register of L\+S\+M303\+D. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{structhalAccmag__dataContainer}{hal\+Accmag\+\_\+data\+Container} \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\+\_\+hal\+Accmag\+\_\+sensor\+State\+\_\+st}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{accMag_8c_a3914b0d0b4d88f06880b47766f844fc8_a3914b0d0b4d88f06880b47766f844fc8}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Mag\+Container\+\_\+st@{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Mag\+Container\+\_\+st}}
\index{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Mag\+Container\+\_\+st@{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Mag\+Container\+\_\+st}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Mag\+Container\+\_\+st}]{\setlength{\rightskip}{0pt plus 5cm}{\bf hal\+Accmag\+\_\+data\+Container} g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Mag\+Container\+\_\+st (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{accMag_8c_a3914b0d0b4d88f06880b47766f844fc8_a3914b0d0b4d88f06880b47766f844fc8}


Get complete data container (acceleration \& compass) 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/05
\end{DoxyDate}
This function returns the complete accelerometer and magnetometer state. Attention\+: To retrieve a new measurement a measurement trigger is to be called first!


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em Container} & with compass and acceleration data\\
\hline
\end{DoxyParams}


Definition at line 653 of file acc\+Mag.\+c.


\begin{DoxyCode}
654 \{
655     \textcolor{keywordflow}{return} \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\_halAccmag\_sensorState\_st};
656 \}
\end{DoxyCode}
\hypertarget{accMag_8c_aebfdb7e3d86187e1fecee863424aa3fc_aebfdb7e3d86187e1fecee863424aa3fc}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Vector\+\_\+st@{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Vector\+\_\+st}}
\index{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Vector\+\_\+st@{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Vector\+\_\+st}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Vector\+\_\+st}]{\setlength{\rightskip}{0pt plus 5cm}{\bf hal\+Accmag\+\_\+3d\+Double\+Vector} g\+\_\+hal\+Accmag\+\_\+get\+Acc\+Vector\+\_\+st (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{accMag_8c_aebfdb7e3d86187e1fecee863424aa3fc_aebfdb7e3d86187e1fecee863424aa3fc}


Get current state of acceleration. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/05
\end{DoxyDate}
This function returns the current state of the accelerometer.~\newline
 Attention\+: To retrieve a new measurement the measurement trigger is to be called first!


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em 3\+D} & vector of acceleration components (x,y,z)\\
\hline
\end{DoxyParams}


Definition at line 611 of file acc\+Mag.\+c.


\begin{DoxyCode}
612 \{
613     \textcolor{keywordflow}{return} \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\_halAccmag\_sensorState\_st}.\hyperlink{structhalAccmag__dataContainer_afc3847993eed1c8f1e67028ad6d2a6cf_afc3847993eed1c8f1e67028ad6d2a6cf}{acc};
614 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_aebfdb7e3d86187e1fecee863424aa3fc_aebfdb7e3d86187e1fecee863424aa3fc_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_ad4f25c6a1f31b6eb494243aa0706986a_ad4f25c6a1f31b6eb494243aa0706986a}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!g\+\_\+hal\+Accmag\+\_\+get\+Mag\+Vector\+\_\+st@{g\+\_\+hal\+Accmag\+\_\+get\+Mag\+Vector\+\_\+st}}
\index{g\+\_\+hal\+Accmag\+\_\+get\+Mag\+Vector\+\_\+st@{g\+\_\+hal\+Accmag\+\_\+get\+Mag\+Vector\+\_\+st}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{g\+\_\+hal\+Accmag\+\_\+get\+Mag\+Vector\+\_\+st}]{\setlength{\rightskip}{0pt plus 5cm}{\bf hal\+Accmag\+\_\+3d\+Double\+Vector} g\+\_\+hal\+Accmag\+\_\+get\+Mag\+Vector\+\_\+st (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{accMag_8c_ad4f25c6a1f31b6eb494243aa0706986a_ad4f25c6a1f31b6eb494243aa0706986a}


Get current state of compass. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/05
\end{DoxyDate}
This function returns the current state of the magnetometer.~\newline
 Attention\+: To retrieve a new measurement the measurement trigger is to be called first!


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em 3\+D} & vector of compass components (x,y,z)\\
\hline
\end{DoxyParams}


Definition at line 632 of file acc\+Mag.\+c.


\begin{DoxyCode}
633 \{
634     \textcolor{keywordflow}{return} \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\_halAccmag\_sensorState\_st}.\hyperlink{structhalAccmag__dataContainer_a903681a66ce49c39267aa66d471812f7_a903681a66ce49c39267aa66d471812f7}{mag};
635 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_ad4f25c6a1f31b6eb494243aa0706986a_ad4f25c6a1f31b6eb494243aa0706986a_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_ab936c0ac53ff9ba47a138e841a6ba474_ab936c0ac53ff9ba47a138e841a6ba474}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!g\+\_\+hal\+Accmag\+\_\+init\+Sensor\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+init\+Sensor\+\_\+bl}}
\index{g\+\_\+hal\+Accmag\+\_\+init\+Sensor\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+init\+Sensor\+\_\+bl}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{g\+\_\+hal\+Accmag\+\_\+init\+Sensor\+\_\+bl}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int g\+\_\+hal\+Accmag\+\_\+init\+Sensor\+\_\+bl (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{accMag_8c_ab936c0ac53ff9ba47a138e841a6ba474_ab936c0ac53ff9ba47a138e841a6ba474}


Initialize sensor. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/05
\end{DoxyDate}
Sends all commands on I2\+C to initialize the acc.-\/ and magnetometer. It uses on big 8 byte config buffer to set all necessary bits. This way, a burst write to the control registers of L\+S\+M303\+D is performed to reduce the I2\+C bus load.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}


Definition at line 472 of file acc\+Mag.\+c.


\begin{DoxyCode}
473 \{
474     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} l\_configRegisters\_rg8ui8[8];  \textcolor{comment}{//buffer for 8 control register bytes}
475 
476     \textcolor{comment}{//Identify sensor}
477     \textcolor{keywordflow}{if} ( \hyperlink{accMag_8c_abaacf0917ab7bbc9b9d13b9aeb31afd1_abaacf0917ab7bbc9b9d13b9aeb31afd1}{l\_readI2cByte\_ui8}( \hyperlink{accMag__registers_8h_ab6a6aee06d3166d947d3a70063f416b3_ab6a6aee06d3166d947d3a70063f416b3}{M\_HAL\_ACCMAG\_WHO\_AM\_I\_UI8} ) != 
      \hyperlink{accMag__registers_8h_a950216893447ed37b695528e45c57618_a950216893447ed37b695528e45c57618}{M\_HAL\_ACCMAG\_WHO\_AM\_I\_PATTERN\_UI8} )
478     \{
479         \textcolor{comment}{// sensor could not be identified --> abort initialization}
480         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
481     \}
482 
483     \textcolor{comment}{/*}
484 \textcolor{comment}{     * ACCELEROMETER}
485 \textcolor{comment}{     */}
486     \textcolor{comment}{// CTRL0: no FIFO (default values)}
487     l\_configRegisters\_rg8ui8[0] = 0b00000000;
488 
489     \textcolor{comment}{// CTRL1: Enable accelerometer, 800Hz sampling}
490     l\_configRegisters\_rg8ui8[1] = (     \hyperlink{accMag__registers_8h_a2488215dc8f9f76a8a9ffb5b6ea4a4fe_a2488215dc8f9f76a8a9ffb5b6ea4a4fe}{M\_HAL\_ACCMAG\_CTRL1\_MASK\_AXEN\_UI8}
491             |   \hyperlink{accMag__registers_8h_a0e5dcc95c72afb32f40fa3bfb61a7835_a0e5dcc95c72afb32f40fa3bfb61a7835}{M\_HAL\_ACCMAG\_CTRL1\_MASK\_AYEN\_UI8}
492             |   \hyperlink{accMag__registers_8h_ac7edba8d670faf8dda4e20eb9de06174_ac7edba8d670faf8dda4e20eb9de06174}{M\_HAL\_ACCMAG\_CTRL1\_MASK\_AZEN\_UI8}
493             |   \hyperlink{accMag__registers_8h_a216ee780b8f610021559d34ad381f83a_a216ee780b8f610021559d34ad381f83a}{M\_HAL\_ACCMAG\_CTRL1\_MASK\_ACC\_RATE\_800HZ\_UI8});
494 
495     \textcolor{comment}{// CTRL2 register (default values): Set scale +/-8G (accelerometer) & Anti-Alias-Filter ~200Hz}
496     l\_configRegisters\_rg8ui8[2] = (     \hyperlink{accMag__registers_8h_ab1b5657c771f26f4f07259d7dda17306_ab1b5657c771f26f4f07259d7dda17306}{M\_HAL\_ACCMAG\_CTRL2\_MASK\_ACC\_SCALE\_8G\_UI8}
497                                     |   
      \hyperlink{accMag__registers_8h_a61b4779cb4dda10ffcca4b985a44148c_a61b4779cb4dda10ffcca4b985a44148c}{M\_HAL\_ACCMAG\_CTRL2\_MASK\_ACC\_BANDWIDTH\_194HZ\_UI8} );
498 
499     \textcolor{comment}{// CTRL3 register (default values): Disable all interrupts}
500     l\_configRegisters\_rg8ui8[3] = 0b00000000;
501 
502     \textcolor{comment}{//CTRL4 register (default values)}
503     l\_configRegisters\_rg8ui8[4] = 0b00000000;
504 
505     \textcolor{comment}{/*}
506 \textcolor{comment}{     * MAGNETOMETER}
507 \textcolor{comment}{     */}
508     \textcolor{comment}{// CTRL5 register: Disable Temp.-sensor, set high-resolution, set 100Hz data rate}
509     l\_configRegisters\_rg8ui8[5] = (     \hyperlink{accMag__registers_8h_afdeb0f958129a4d30ad46ed6d5f8fc44_afdeb0f958129a4d30ad46ed6d5f8fc44}{M\_HAL\_ACCMAG\_CTRL5\_MASK\_MAG\_RES\_HIGH\_UI8}
510             |   \hyperlink{accMag__registers_8h_a58bc09732ac5aeaea2982992cb7f871d_a58bc09732ac5aeaea2982992cb7f871d}{M\_HAL\_ACCMAG\_CTRL5\_MASK\_MAG\_RATE\_100HZ\_UI8} );
511 
512     \textcolor{comment}{// CTRL6 register: set scale +/-0.4mT}
513     l\_configRegisters\_rg8ui8[6] = \hyperlink{accMag__registers_8h_a0c8e435e8dcc3102cf14639d0b530ffd_a0c8e435e8dcc3102cf14639d0b530ffd}{M\_HAL\_ACCMAG\_CTRL6\_MASK\_MAG\_SCALE\_4GAUSS\_UI8}
      ;
514 
515     \textcolor{comment}{// CTRL7 register (default values): set continuous-conversion mode (magnetometer)}
516     l\_configRegisters\_rg8ui8[7] = 
      \hyperlink{accMag__registers_8h_ad0329f6db53325bb06a32d943cfcc89d_ad0329f6db53325bb06a32d943cfcc89d}{M\_HAL\_ACCMAG\_CTRL7\_MASK\_MAG\_SENSMODE\_CONTINOUS\_UI8};
517 
518 
519     \textcolor{comment}{// send config}
520     \textcolor{keywordflow}{if} ( \hyperlink{accMag_8c_af4a867d90abb126d82ba14ea2619f305_af4a867d90abb126d82ba14ea2619f305}{l\_writeI2cByteStream\_bl}(\hyperlink{accMag__registers_8h_a06bad79fdc9974e058241fd84e2f7b7b_a06bad79fdc9974e058241fd84e2f7b7b}{M\_HAL\_ACCMAG\_CTRL0\_UI8}, 
      l\_configRegisters\_rg8ui8, \textcolor{keyword}{sizeof}(l\_configRegisters\_rg8ui8) ) == \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL} )
521     \{
522         \textcolor{comment}{// setting register CTRL1 failed}
523         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
524     \}
525 
526     \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL};
527 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_ab936c0ac53ff9ba47a138e841a6ba474_ab936c0ac53ff9ba47a138e841a6ba474_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_ab936c0ac53ff9ba47a138e841a6ba474_ab936c0ac53ff9ba47a138e841a6ba474_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_ad5f9d3a28348a9889f9afecde79606f6_ad5f9d3a28348a9889f9afecde79606f6}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!g\+\_\+hal\+Accmag\+\_\+trigger\+Acc\+Update\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+trigger\+Acc\+Update\+\_\+bl}}
\index{g\+\_\+hal\+Accmag\+\_\+trigger\+Acc\+Update\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+trigger\+Acc\+Update\+\_\+bl}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{g\+\_\+hal\+Accmag\+\_\+trigger\+Acc\+Update\+\_\+bl}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int g\+\_\+hal\+Accmag\+\_\+trigger\+Acc\+Update\+\_\+bl (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{accMag_8c_ad5f9d3a28348a9889f9afecde79606f6_ad5f9d3a28348a9889f9afecde79606f6}


Trigger a new measurement of the accelerometer. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/13
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}


Definition at line 546 of file acc\+Mag.\+c.


\begin{DoxyCode}
547 \{
548     \textcolor{keywordflow}{return} \hyperlink{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b}{l\_updateSensorState\_vd}(\hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8a785fd0a49fbb18e5a2e65b8af35d6abc}{SENSOR\_ACC\_EN});
549 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_ad5f9d3a28348a9889f9afecde79606f6_ad5f9d3a28348a9889f9afecde79606f6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_ad5f9d3a28348a9889f9afecde79606f6_ad5f9d3a28348a9889f9afecde79606f6_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_a98cf3442152a9ae213517936f7b37fe0_a98cf3442152a9ae213517936f7b37fe0}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!g\+\_\+hal\+Accmag\+\_\+trigger\+Full\+Update\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+trigger\+Full\+Update\+\_\+bl}}
\index{g\+\_\+hal\+Accmag\+\_\+trigger\+Full\+Update\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+trigger\+Full\+Update\+\_\+bl}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{g\+\_\+hal\+Accmag\+\_\+trigger\+Full\+Update\+\_\+bl}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int g\+\_\+hal\+Accmag\+\_\+trigger\+Full\+Update\+\_\+bl (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{accMag_8c_a98cf3442152a9ae213517936f7b37fe0_a98cf3442152a9ae213517936f7b37fe0}


Trigger a new measurement of both sensors. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/13
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}


Definition at line 590 of file acc\+Mag.\+c.


\begin{DoxyCode}
591 \{
592     \textcolor{keywordflow}{return} \hyperlink{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b}{l\_updateSensorState\_vd}(\hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8a2801a1fb951d195fa4c2d621bd352a79}{SENSOR\_BOTH\_EN});
593 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_a98cf3442152a9ae213517936f7b37fe0_a98cf3442152a9ae213517936f7b37fe0_cgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_afdbd4ece113ff4859718b678150d069a_afdbd4ece113ff4859718b678150d069a}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!g\+\_\+hal\+Accmag\+\_\+trigger\+Mag\+Update\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+trigger\+Mag\+Update\+\_\+bl}}
\index{g\+\_\+hal\+Accmag\+\_\+trigger\+Mag\+Update\+\_\+bl@{g\+\_\+hal\+Accmag\+\_\+trigger\+Mag\+Update\+\_\+bl}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{g\+\_\+hal\+Accmag\+\_\+trigger\+Mag\+Update\+\_\+bl}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int g\+\_\+hal\+Accmag\+\_\+trigger\+Mag\+Update\+\_\+bl (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{accMag_8c_afdbd4ece113ff4859718b678150d069a_afdbd4ece113ff4859718b678150d069a}


Trigger a new measurement of the magnetometer. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/13
\end{DoxyDate}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}


Definition at line 568 of file acc\+Mag.\+c.


\begin{DoxyCode}
569 \{
570     \textcolor{keywordflow}{return} \hyperlink{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b}{l\_updateSensorState\_vd}(\hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8a2a54a90cabb4985b0bd3bcb7d5b54d28}{SENSOR\_MAG\_EN});
571 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_afdbd4ece113ff4859718b678150d069a_afdbd4ece113ff4859718b678150d069a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_afdbd4ece113ff4859718b678150d069a_afdbd4ece113ff4859718b678150d069a_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_a3f6ef9cd19c5f23888aaca4b1ba34ecc_a3f6ef9cd19c5f23888aaca4b1ba34ecc}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!l\+\_\+convert\+Acc\+Raw\+To\+S\+I\+Unit\+\_\+f64@{l\+\_\+convert\+Acc\+Raw\+To\+S\+I\+Unit\+\_\+f64}}
\index{l\+\_\+convert\+Acc\+Raw\+To\+S\+I\+Unit\+\_\+f64@{l\+\_\+convert\+Acc\+Raw\+To\+S\+I\+Unit\+\_\+f64}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{l\+\_\+convert\+Acc\+Raw\+To\+S\+I\+Unit\+\_\+f64}]{\setlength{\rightskip}{0pt plus 5cm}static double l\+\_\+convert\+Acc\+Raw\+To\+S\+I\+Unit\+\_\+f64 (
\begin{DoxyParamCaption}
\item[{signed short}]{f\+\_\+raw\+Acc\+Val\+\_\+i16, }
\item[{unsigned char}]{f\+\_\+scaling\+Value\+G\+\_\+ui8}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{accMag_8c_a3f6ef9cd19c5f23888aaca4b1ba34ecc_a3f6ef9cd19c5f23888aaca4b1ba34ecc}


Converts raw sensor values of the accelerometer into S\+I unit. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/11
\end{DoxyDate}
This function converts the raw sensor values (signed 16bit integers)of the accelerometer into S\+I unit (64bit float). The unit for the accelerometer is \[ \frac{m}{s^2} \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+raw\+Mag\+Val\+\_\+i16} & is raw signed 16bit sensor value \\
\hline
\mbox{\tt in}  & {\em f\+\_\+scaling\+Value\+\_\+ui8} & is the absolute value of the max. scale defined in the sensor's control registers.~\newline
 Example\+: maximal sensor range \char`\"{}+/-\/ 8\+G\char`\"{} will result in \char`\"{}8\char`\"{} \\
\hline
\mbox{\tt out}  & {\em returns} & a 64bit float value in S\+I units ( \[ \frac{m}{s^2} \])\\
\hline
\end{DoxyParams}


Definition at line 337 of file acc\+Mag.\+c.


\begin{DoxyCode}
338 \{
339     \textcolor{keywordtype}{double}          l\_outputValue\_f64   = 0;
340     \textcolor{keyword}{const} \textcolor{keywordtype}{double}    l\_gravityConst\_f64  = 9.81; \textcolor{comment}{// m*(s^-2) per G}
341 
342     \textcolor{comment}{// unitless [-1,1]}
343     l\_outputValue\_f64 = (double)f\_scalingValueG\_ui8 * (\textcolor{keywordtype}{double})f\_rawAccVal\_i16 / (double)SHRT\_MAX;
344 
345     \textcolor{comment}{// Units: 1 * m*s^(-2)*G^(-1) * G = m*s^(-2)}
346     l\_outputValue\_f64 = l\_outputValue\_f64 * l\_gravityConst\_f64;
347 
348     \textcolor{keywordflow}{return} l\_outputValue\_f64;  \textcolor{comment}{// m*(s^-2)}
349 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_a3f6ef9cd19c5f23888aaca4b1ba34ecc_a3f6ef9cd19c5f23888aaca4b1ba34ecc_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_a1f0866c5afdce148afc09ed1c5a8018f_a1f0866c5afdce148afc09ed1c5a8018f}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!l\+\_\+convert\+Mag\+Raw\+To\+S\+I\+Unit\+\_\+f64@{l\+\_\+convert\+Mag\+Raw\+To\+S\+I\+Unit\+\_\+f64}}
\index{l\+\_\+convert\+Mag\+Raw\+To\+S\+I\+Unit\+\_\+f64@{l\+\_\+convert\+Mag\+Raw\+To\+S\+I\+Unit\+\_\+f64}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{l\+\_\+convert\+Mag\+Raw\+To\+S\+I\+Unit\+\_\+f64}]{\setlength{\rightskip}{0pt plus 5cm}static double l\+\_\+convert\+Mag\+Raw\+To\+S\+I\+Unit\+\_\+f64 (
\begin{DoxyParamCaption}
\item[{signed short}]{f\+\_\+raw\+Mag\+Val\+\_\+i16, }
\item[{unsigned char}]{f\+\_\+scaling\+Value\+Gauss\+\_\+ui8}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{accMag_8c_a1f0866c5afdce148afc09ed1c5a8018f_a1f0866c5afdce148afc09ed1c5a8018f}


Converts raw sensor values of the magnetometer into S\+I unit. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/11
\end{DoxyDate}
This function converts the raw sensor values (signed 16bit integers)of the magnetometer into S\+I unit (64bit float). The unit for the magnetometer is Tesla~\newline
 (S\+I representation\+: Tesla = \[ \frac{kg}{s^2\dotA} \])


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+raw\+Mag\+Val\+\_\+i16} & is raw signed 16bit sensor value \\
\hline
\mbox{\tt in}  & {\em f\+\_\+scaling\+Value\+\_\+ui8} & is the absolute value of the scale defined maximal sensor value range (e.\+g. \char`\"{}+/-\/4 Gauss\char`\"{} will result in \char`\"{}4\char`\"{}) \\
\hline
\mbox{\tt out}  & {\em returns} & a 64bit float value in S\+I units~\newline
 (Tesla = \[ \frac{kg}{s^2\dotA} \])\\
\hline
\end{DoxyParams}


Definition at line 303 of file acc\+Mag.\+c.


\begin{DoxyCode}
304 \{
305     \textcolor{keywordtype}{double}          l\_outputValue\_f64 = 0;
306     \textcolor{keyword}{const} \textcolor{keywordtype}{double}    l\_gaussToSI\_f64 = 0.1E-3;   \textcolor{comment}{//1Gauss = 0.1mT = 0.1*10^(-3)T}
307 
308     \textcolor{comment}{// unitless [-1,1]}
309     l\_outputValue\_f64 = (double)f\_rawMagVal\_i16 / (\textcolor{keywordtype}{double})SHRT\_MAX;
310 
311     \textcolor{comment}{// Units: 1 * T*Gauss^(-1) * Gauss = m*s^(-2)}
312     l\_outputValue\_f64 = l\_outputValue\_f64 * l\_gaussToSI\_f64 * (double)f\_scalingValueGauss\_ui8;
313 
314     \textcolor{keywordflow}{return} l\_outputValue\_f64;   \textcolor{comment}{//Tesla}
315 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_a1f0866c5afdce148afc09ed1c5a8018f_a1f0866c5afdce148afc09ed1c5a8018f_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_abaacf0917ab7bbc9b9d13b9aeb31afd1_abaacf0917ab7bbc9b9d13b9aeb31afd1}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!l\+\_\+read\+I2c\+Byte\+\_\+ui8@{l\+\_\+read\+I2c\+Byte\+\_\+ui8}}
\index{l\+\_\+read\+I2c\+Byte\+\_\+ui8@{l\+\_\+read\+I2c\+Byte\+\_\+ui8}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{l\+\_\+read\+I2c\+Byte\+\_\+ui8}]{\setlength{\rightskip}{0pt plus 5cm}static unsigned char l\+\_\+read\+I2c\+Byte\+\_\+ui8 (
\begin{DoxyParamCaption}
\item[{unsigned char}]{f\+\_\+register\+Addr\+\_\+ui8}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{accMag_8c_abaacf0917ab7bbc9b9d13b9aeb31afd1_abaacf0917ab7bbc9b9d13b9aeb31afd1}


Wrapper function to read a single byte register of L\+S\+M303\+D. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/05
\end{DoxyDate}
This function is a wrapper to the I2\+C Interface to read one single byte of the Accelerometer/\+Magnetometer (L\+S\+M303\+D). It eases the write and read procedure for reading one register byte of the sensor.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+register\+Addr\+\_\+ui8} & specifies the register address to return \\
\hline
\mbox{\tt out}  & {\em returns} & the requested byte of I2\+C data\\
\hline
\end{DoxyParams}


Definition at line 33 of file acc\+Mag.\+c.


\begin{DoxyCode}
34 \{
35     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}   l\_registerAddr\_ui8 = 0;
36     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}   l\_recvDataByte\_ui8 = 0;
37 
38     \textcolor{comment}{/*}
39 \textcolor{comment}{     * ensure single byte read (MSB of register address shall be 0)}
40 \textcolor{comment}{     * -> Mask MSB to zero!}
41 \textcolor{comment}{     */}
42     l\_registerAddr\_ui8 = f\_registerAddr\_ui8 & 0b01111111;
43 
44     \textcolor{comment}{//write register request to I2C}
45     \textcolor{keywordflow}{if} ( \hyperlink{LLD__I2C_8c_aa6892bf4aea7f232d9b0ff2dbf8a9321_aa6892bf4aea7f232d9b0ff2dbf8a9321}{g\_lldI2c\_WriteI2c\_bl}(\hyperlink{accMag_8h_a6c9acfcf0f8dff7a5789ddb4960b3599_a6c9acfcf0f8dff7a5789ddb4960b3599}{M\_HAL\_ACCMAG\_I2CADDR\_UI8}, &
      l\_registerAddr\_ui8, 1) != \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL} )
46     \{
47         \textcolor{comment}{// error in I2C access}
48         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
49     \}
50 
51     \textcolor{comment}{//read requested register data}
52     \textcolor{keywordflow}{if} ( \hyperlink{LLD__I2C_8c_a107ee9f1e4646733ac3ef6addf0def7e_a107ee9f1e4646733ac3ef6addf0def7e}{g\_lldI2c\_ReadI2c\_bl}(\hyperlink{accMag_8h_a6c9acfcf0f8dff7a5789ddb4960b3599_a6c9acfcf0f8dff7a5789ddb4960b3599}{M\_HAL\_ACCMAG\_I2CADDR\_UI8}, &
      l\_recvDataByte\_ui8, 1) != \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL} )
53     \{
54         \textcolor{comment}{// error in I2C access}
55         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
56     \}
57 
58     \textcolor{keywordflow}{return} l\_recvDataByte\_ui8;
59 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{accMag_8c_abaacf0917ab7bbc9b9d13b9aeb31afd1_abaacf0917ab7bbc9b9d13b9aeb31afd1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_abaacf0917ab7bbc9b9d13b9aeb31afd1_abaacf0917ab7bbc9b9d13b9aeb31afd1_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_a84dc4f1647051d5c34296705fa1f236b_a84dc4f1647051d5c34296705fa1f236b}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!l\+\_\+read\+I2c\+Byte\+Stream\+\_\+bl@{l\+\_\+read\+I2c\+Byte\+Stream\+\_\+bl}}
\index{l\+\_\+read\+I2c\+Byte\+Stream\+\_\+bl@{l\+\_\+read\+I2c\+Byte\+Stream\+\_\+bl}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{l\+\_\+read\+I2c\+Byte\+Stream\+\_\+bl}]{\setlength{\rightskip}{0pt plus 5cm}static unsigned int l\+\_\+read\+I2c\+Byte\+Stream\+\_\+bl (
\begin{DoxyParamCaption}
\item[{unsigned char}]{f\+\_\+start\+Register\+Addr\+\_\+ui8, }
\item[{const unsigned char $\ast$}]{f\+\_\+read\+Destination\+Buffer\+\_\+pui8, }
\item[{unsigned int}]{f\+\_\+num\+Of\+Bytes\+To\+Read\+\_\+ui32}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{accMag_8c_a84dc4f1647051d5c34296705fa1f236b_a84dc4f1647051d5c34296705fa1f236b}


Wrapper function to read byte stream to registers of L\+S\+M303\+D. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/08
\end{DoxyDate}
This function is a wrapper to the I2\+C Interface to read a byte stream to a series of registers of the Accelerometer/ Magnetometer (L\+S\+M303\+D). The first register address can be defined in the parameter list of the function. After reading the first byte of the start address, the register address will be incremented.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+start\+Register\+Addr\+\_\+ui8} & specifies the first register address to return \\
\hline
\mbox{\tt in}  & {\em f\+\_\+read\+Destination\+Buffer\+\_\+pui8} & points to an array of unsigned 8bit integer elements. This array receives all read data bytes (output byte stream buffer). \\
\hline
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}


Definition at line 88 of file acc\+Mag.\+c.


\begin{DoxyCode}
89 \{
90     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}   l\_registerAddr\_ui8  = 0;
91 
92     \textcolor{comment}{// ensure at least one data byte to read}
93     \textcolor{keywordflow}{if} (f\_numOfBytesToRead\_ui32 < 1)
94     \{
95         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
96     \}
97 
98     \textcolor{comment}{/*}
99 \textcolor{comment}{     * ensure byte stream reading (MSB of register address shall be 1)}
100 \textcolor{comment}{     *   -> Mask MSB to one!}
101 \textcolor{comment}{     *   -> LSM303D will auto-increment the register address for each byte}
102 \textcolor{comment}{     *      of data}
103 \textcolor{comment}{     */}
104     l\_registerAddr\_ui8 = f\_startRegisterAddr\_ui8 | 0b10000000;
105 
106     \textcolor{comment}{//write register request to I2C}
107     \textcolor{keywordflow}{if} ( \hyperlink{LLD__I2C_8c_aa6892bf4aea7f232d9b0ff2dbf8a9321_aa6892bf4aea7f232d9b0ff2dbf8a9321}{g\_lldI2c\_WriteI2c\_bl}(\hyperlink{accMag_8h_a6c9acfcf0f8dff7a5789ddb4960b3599_a6c9acfcf0f8dff7a5789ddb4960b3599}{M\_HAL\_ACCMAG\_I2CADDR\_UI8}, &
      l\_registerAddr\_ui8, 1) != \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL} )
108     \{
109         \textcolor{comment}{// error in I2C access}
110         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
111     \}
112 
113     \textcolor{comment}{//read requested registers to I2C}
114     \textcolor{keywordflow}{if} ( \hyperlink{LLD__I2C_8c_a107ee9f1e4646733ac3ef6addf0def7e_a107ee9f1e4646733ac3ef6addf0def7e}{g\_lldI2c\_ReadI2c\_bl}(\hyperlink{accMag_8h_a6c9acfcf0f8dff7a5789ddb4960b3599_a6c9acfcf0f8dff7a5789ddb4960b3599}{M\_HAL\_ACCMAG\_I2CADDR\_UI8}, 
      f\_readDestinationBuffer\_pui8, f\_numOfBytesToRead\_ui32) != \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL} )
115     \{
116         \textcolor{comment}{// error in I2C access}
117         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
118     \}
119 
120     \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL};
121 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{accMag_8c_a84dc4f1647051d5c34296705fa1f236b_a84dc4f1647051d5c34296705fa1f236b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_a84dc4f1647051d5c34296705fa1f236b_a84dc4f1647051d5c34296705fa1f236b_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!l\+\_\+two\+Comp\+Of16\+Bit\+\_\+ui16@{l\+\_\+two\+Comp\+Of16\+Bit\+\_\+ui16}}
\index{l\+\_\+two\+Comp\+Of16\+Bit\+\_\+ui16@{l\+\_\+two\+Comp\+Of16\+Bit\+\_\+ui16}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{l\+\_\+two\+Comp\+Of16\+Bit\+\_\+ui16}]{\setlength{\rightskip}{0pt plus 5cm}static signed short l\+\_\+two\+Comp\+Of16\+Bit\+\_\+ui16 (
\begin{DoxyParamCaption}
\item[{unsigned char}]{f\+\_\+lsb\+\_\+ui8, }
\item[{unsigned char}]{f\+\_\+msb\+\_\+ui8}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}


Complement of twos of a 16 bit integer. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/10
\end{DoxyDate}
This function computes the two's complement of two 8bit integers (most significant and least significant bytes)


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+lsb\+\_\+ui8} & is the least significant byte \\
\hline
\mbox{\tt in}  & {\em f\+\_\+msb\+\_\+ui8} & is the most significant byte \\
\hline
\mbox{\tt out}  & {\em returns} & a unsigned 16bit integer of the two's complement\\
\hline
\end{DoxyParams}


Definition at line 265 of file acc\+Mag.\+c.


\begin{DoxyCode}
266 \{
267     \textcolor{keywordtype}{signed} \textcolor{keywordtype}{short}    l\_compOfTwo\_ui16 = 0; \textcolor{comment}{//init variable with zeros}
268 
269     \textcolor{comment}{/*}
270 \textcolor{comment}{     * 1. assemble 16bit value of two 8bit chunks}
271 \textcolor{comment}{     * 2. invert 16bit}
272 \textcolor{comment}{     * 3. add 1 to 16bit value}
273 \textcolor{comment}{     * 4. mask only 16bit range (to avoid overflows)}
274 \textcolor{comment}{     * --> conversion of two's complement}
275 \textcolor{comment}{     */}
276     l\_compOfTwo\_ui16 = (\textcolor{keywordtype}{signed} short)( ( ~((\textcolor{keywordtype}{int})(f\_msb\_ui8 << 8) + (\textcolor{keywordtype}{int})(f\_lsb\_ui8)) + (\textcolor{keywordtype}{int})1 ) & (int)0
      xFFFF );
277 
278     \textcolor{keywordflow}{return} l\_compOfTwo\_ui16;
279 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!l\+\_\+update\+Sensor\+State\+\_\+vd@{l\+\_\+update\+Sensor\+State\+\_\+vd}}
\index{l\+\_\+update\+Sensor\+State\+\_\+vd@{l\+\_\+update\+Sensor\+State\+\_\+vd}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{l\+\_\+update\+Sensor\+State\+\_\+vd}]{\setlength{\rightskip}{0pt plus 5cm}static unsigned int l\+\_\+update\+Sensor\+State\+\_\+vd (
\begin{DoxyParamCaption}
\item[{{\bf hal\+Accmag\+\_\+sensor\+Select}}]{f\+\_\+sensor\+\_\+en}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b}


Trigger a update of the current sensor state data. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/05
\end{DoxyDate}
This function accesses the accelereation and compass sensor via I2\+C to load a new measurement to the sensor state storage


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+sensor\+\_\+en} & is a enum type that indicates, which sensor(s) shall be updated \\
\hline
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}


Definition at line 371 of file acc\+Mag.\+c.


\begin{DoxyCode}
372 \{
373     \hyperlink{structhalAccmag__3dDoubleVector}{halAccmag\_3dDoubleVector}    l\_accBuffer\_st;
374     \hyperlink{structhalAccmag__3dDoubleVector}{halAccmag\_3dDoubleVector}    l\_magBuffer\_st;
375     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}               l\_readBuffer\_rg6ui8[6];
376     \textcolor{keywordtype}{signed} \textcolor{keywordtype}{short}                l\_tempComponent\_i16 = 0;
377     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}                l\_successState\_bl = \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL};
378 
379     \textcolor{comment}{//init local data buffers with current values}
380     l\_accBuffer\_st = \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\_halAccmag\_sensorState\_st}.\hyperlink{structhalAccmag__dataContainer_afc3847993eed1c8f1e67028ad6d2a6cf_afc3847993eed1c8f1e67028ad6d2a6cf}{acc};
381     l\_magBuffer\_st = \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\_halAccmag\_sensorState\_st}.\hyperlink{structhalAccmag__dataContainer_a903681a66ce49c39267aa66d471812f7_a903681a66ce49c39267aa66d471812f7}{mag};
382 
383     \textcolor{comment}{/*}
384 \textcolor{comment}{     * READ ACCELEROMETER}
385 \textcolor{comment}{     * - uses sequential read (auto-increment)}
386 \textcolor{comment}{     * - sequence as follows:}
387 \textcolor{comment}{     *   (Byte 1) X-Component, LSB}
388 \textcolor{comment}{     *   (Byte 2) X-Component, MSB}
389 \textcolor{comment}{     *   (Byte 3) Y-Component, LSB}
390 \textcolor{comment}{     *   (Byte 4) Y-Component, MSB}
391 \textcolor{comment}{     *   (Byte 5) Z-Component, LSB}
392 \textcolor{comment}{     *   (Byte 6) Z-Component, MSB}
393 \textcolor{comment}{     */}
394     \textcolor{keywordflow}{if} ( (f\_sensor\_en == \hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8a785fd0a49fbb18e5a2e65b8af35d6abc}{SENSOR\_ACC\_EN}) || (f\_sensor\_en == 
      \hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8a2801a1fb951d195fa4c2d621bd352a79}{SENSOR\_BOTH\_EN}) )
395     \{
396         \textcolor{keywordflow}{if} ( \hyperlink{accMag_8c_a84dc4f1647051d5c34296705fa1f236b_a84dc4f1647051d5c34296705fa1f236b}{l\_readI2cByteStream\_bl}(
      \hyperlink{accMag__registers_8h_a93160006c4218905810ab70c3bddfe05_a93160006c4218905810ab70c3bddfe05}{M\_HAL\_ACCMAG\_OUT\_X\_L\_A\_UI8},l\_readBuffer\_rg6ui8, 6) == 
      \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL} )
397         \{
398             \textcolor{comment}{// x-component}
399             l\_tempComponent\_i16 = \hyperlink{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{l\_twoCompOf16Bit\_ui16}(l\_readBuffer\_rg6ui8[0], 
      l\_readBuffer\_rg6ui8[1]);
400             l\_accBuffer\_st.\hyperlink{structhalAccmag__3dDoubleVector_a011646ea6f4b78400dfd2ffa8eb45eea_a011646ea6f4b78400dfd2ffa8eb45eea}{x\_f64} = \hyperlink{accMag_8c_a3f6ef9cd19c5f23888aaca4b1ba34ecc_a3f6ef9cd19c5f23888aaca4b1ba34ecc}{l\_convertAccRawToSIUnit\_f64}( 
      l\_tempComponent\_i16, \hyperlink{accMag_8h_a44405d1fc6d79b1588b5ce1549f5af52_a44405d1fc6d79b1588b5ce1549f5af52}{M\_HAL\_ACCMAG\_ACCSCALE\_UI8} );
401 
402             \textcolor{comment}{// y-component}
403             l\_tempComponent\_i16 = \hyperlink{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{l\_twoCompOf16Bit\_ui16}(l\_readBuffer\_rg6ui8[2], 
      l\_readBuffer\_rg6ui8[3]);
404             l\_accBuffer\_st.\hyperlink{structhalAccmag__3dDoubleVector_a88f4ed3363ccaa08c00d2fc28f7b2ab4_a88f4ed3363ccaa08c00d2fc28f7b2ab4}{y\_f64} = \hyperlink{accMag_8c_a3f6ef9cd19c5f23888aaca4b1ba34ecc_a3f6ef9cd19c5f23888aaca4b1ba34ecc}{l\_convertAccRawToSIUnit\_f64}( 
      l\_tempComponent\_i16, \hyperlink{accMag_8h_a44405d1fc6d79b1588b5ce1549f5af52_a44405d1fc6d79b1588b5ce1549f5af52}{M\_HAL\_ACCMAG\_ACCSCALE\_UI8} );
405 
406             \textcolor{comment}{// z-component}
407             l\_tempComponent\_i16 = \hyperlink{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{l\_twoCompOf16Bit\_ui16}(l\_readBuffer\_rg6ui8[4], 
      l\_readBuffer\_rg6ui8[5]);
408             l\_accBuffer\_st.\hyperlink{structhalAccmag__3dDoubleVector_a5041b0551694f5f4057a5f3454782e44_a5041b0551694f5f4057a5f3454782e44}{z\_f64} = \hyperlink{accMag_8c_a3f6ef9cd19c5f23888aaca4b1ba34ecc_a3f6ef9cd19c5f23888aaca4b1ba34ecc}{l\_convertAccRawToSIUnit\_f64}( 
      l\_tempComponent\_i16, \hyperlink{accMag_8h_a44405d1fc6d79b1588b5ce1549f5af52_a44405d1fc6d79b1588b5ce1549f5af52}{M\_HAL\_ACCMAG\_ACCSCALE\_UI8} );
409         \}\textcolor{keywordflow}{else}\{
410             l\_successState\_bl = \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
411         \}
412 
413     \}
414     \textcolor{comment}{/*}
415 \textcolor{comment}{     * READ MAGNETOMETER}
416 \textcolor{comment}{     * - uses sequential read (auto-increment)}
417 \textcolor{comment}{     * - sequence as follows:}
418 \textcolor{comment}{     *   (Byte 1) X-Component, LSB}
419 \textcolor{comment}{     *   (Byte 2) X-Component, MSB}
420 \textcolor{comment}{     *   (Byte 3) Y-Component, LSB}
421 \textcolor{comment}{     *   (Byte 4) Y-Component, MSB}
422 \textcolor{comment}{     *   (Byte 5) Z-Component, LSB}
423 \textcolor{comment}{     *   (Byte 6) Z-Component, MSB}
424 \textcolor{comment}{     */}
425     \textcolor{keywordflow}{if} ( (f\_sensor\_en == \hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8a2a54a90cabb4985b0bd3bcb7d5b54d28}{SENSOR\_MAG\_EN}) || (f\_sensor\_en == 
      \hyperlink{accMag_8h_a648cc7f506bdd006d657bf0c2fc393b8_a648cc7f506bdd006d657bf0c2fc393b8a2801a1fb951d195fa4c2d621bd352a79}{SENSOR\_BOTH\_EN}) )
426     \{
427         \textcolor{keywordflow}{if} ( \hyperlink{accMag_8c_a84dc4f1647051d5c34296705fa1f236b_a84dc4f1647051d5c34296705fa1f236b}{l\_readI2cByteStream\_bl}(
      \hyperlink{accMag__registers_8h_af114cbdb9d5b677730d29543f28b2955_af114cbdb9d5b677730d29543f28b2955}{M\_HAL\_ACCMAG\_OUT\_X\_L\_M\_UI8},l\_readBuffer\_rg6ui8, 6) == 
      \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL} )
428         \{
429             \textcolor{comment}{// x-component}
430             l\_tempComponent\_i16 = \hyperlink{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{l\_twoCompOf16Bit\_ui16}(l\_readBuffer\_rg6ui8[0], 
      l\_readBuffer\_rg6ui8[1]);
431             l\_magBuffer\_st.\hyperlink{structhalAccmag__3dDoubleVector_a011646ea6f4b78400dfd2ffa8eb45eea_a011646ea6f4b78400dfd2ffa8eb45eea}{x\_f64} = \hyperlink{accMag_8c_a1f0866c5afdce148afc09ed1c5a8018f_a1f0866c5afdce148afc09ed1c5a8018f}{l\_convertMagRawToSIUnit\_f64}( 
      l\_tempComponent\_i16, \hyperlink{accMag_8h_a470c76781432ff3b1dad24810d44311d_a470c76781432ff3b1dad24810d44311d}{M\_HAL\_ACCMAG\_MAGSCALE\_UI8} );
432 
433             \textcolor{comment}{// y-component}
434             l\_tempComponent\_i16 = \hyperlink{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{l\_twoCompOf16Bit\_ui16}(l\_readBuffer\_rg6ui8[2], 
      l\_readBuffer\_rg6ui8[3]);
435             l\_magBuffer\_st.\hyperlink{structhalAccmag__3dDoubleVector_a88f4ed3363ccaa08c00d2fc28f7b2ab4_a88f4ed3363ccaa08c00d2fc28f7b2ab4}{y\_f64} = \hyperlink{accMag_8c_a1f0866c5afdce148afc09ed1c5a8018f_a1f0866c5afdce148afc09ed1c5a8018f}{l\_convertMagRawToSIUnit\_f64}( 
      l\_tempComponent\_i16, \hyperlink{accMag_8h_a470c76781432ff3b1dad24810d44311d_a470c76781432ff3b1dad24810d44311d}{M\_HAL\_ACCMAG\_MAGSCALE\_UI8} );
436 
437             \textcolor{comment}{// z-component}
438             l\_tempComponent\_i16 = \hyperlink{accMag_8c_aad5863a0667702ddb0040ab517463069_aad5863a0667702ddb0040ab517463069}{l\_twoCompOf16Bit\_ui16}(l\_readBuffer\_rg6ui8[4], 
      l\_readBuffer\_rg6ui8[5]);
439             l\_magBuffer\_st.\hyperlink{structhalAccmag__3dDoubleVector_a5041b0551694f5f4057a5f3454782e44_a5041b0551694f5f4057a5f3454782e44}{z\_f64} = \hyperlink{accMag_8c_a1f0866c5afdce148afc09ed1c5a8018f_a1f0866c5afdce148afc09ed1c5a8018f}{l\_convertMagRawToSIUnit\_f64}( 
      l\_tempComponent\_i16, \hyperlink{accMag_8h_a470c76781432ff3b1dad24810d44311d_a470c76781432ff3b1dad24810d44311d}{M\_HAL\_ACCMAG\_MAGSCALE\_UI8} );
440         \}\textcolor{keywordflow}{else}\{
441             l\_successState\_bl = \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
442         \}
443     \}
444 
445     \textcolor{comment}{// update sensor state storage values}
446     \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\_halAccmag\_sensorState\_st}.\hyperlink{structhalAccmag__dataContainer_afc3847993eed1c8f1e67028ad6d2a6cf_afc3847993eed1c8f1e67028ad6d2a6cf}{acc} = l\_accBuffer\_st;
447     \hyperlink{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{m\_halAccmag\_sensorState\_st}.\hyperlink{structhalAccmag__dataContainer_a903681a66ce49c39267aa66d471812f7_a903681a66ce49c39267aa66d471812f7}{mag} = l\_magBuffer\_st;
448 
449     \textcolor{keywordflow}{return} l\_successState\_bl;
450 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_a5cef87c49dd46218e083a0c95abb9a9b_a5cef87c49dd46218e083a0c95abb9a9b_icgraph}
\end{center}
\end{figure}


\hypertarget{accMag_8c_af4a867d90abb126d82ba14ea2619f305_af4a867d90abb126d82ba14ea2619f305}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!l\+\_\+write\+I2c\+Byte\+Stream\+\_\+bl@{l\+\_\+write\+I2c\+Byte\+Stream\+\_\+bl}}
\index{l\+\_\+write\+I2c\+Byte\+Stream\+\_\+bl@{l\+\_\+write\+I2c\+Byte\+Stream\+\_\+bl}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{l\+\_\+write\+I2c\+Byte\+Stream\+\_\+bl}]{\setlength{\rightskip}{0pt plus 5cm}static unsigned int l\+\_\+write\+I2c\+Byte\+Stream\+\_\+bl (
\begin{DoxyParamCaption}
\item[{unsigned char}]{f\+\_\+start\+Register\+Addr\+\_\+ui8, }
\item[{const unsigned char $\ast$const}]{f\+\_\+byte\+Stream\+To\+Write\+\_\+pui8, }
\item[{unsigned int}]{f\+\_\+num\+Of\+Bytes\+\_\+ui32}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{accMag_8c_af4a867d90abb126d82ba14ea2619f305_af4a867d90abb126d82ba14ea2619f305}


Wrapper function to write a single byte register of L\+S\+M303\+D. 



 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/05
\end{DoxyDate}
This function is a wrapper to the I2\+C Interface to write one single byte to a register of the Accelerometer/\+Magnetometer (L\+S\+M303\+D). It eases the concatenation of register address and data byte to transmit.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+register\+Addr\+\_\+ui8} & specifies the register address to return \\
\hline
\mbox{\tt in}  & {\em f\+\_\+byte\+To\+Write\+\_\+ui8} & specifies the single byte to write \\
\hline
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}




 \begin{DoxyAuthor}{Author}
Juergen Schmidt (juscgs00) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2014/05/08
\end{DoxyDate}
Wrapper function to write byte stream to registers of L\+S\+M303\+D

This function is a wrapper to the I2\+C Interface to write a byte stream to a series of registers of the Accelerometer/ Magnetometer (L\+S\+M303\+D). The first register address can be defined in the parameter list of the function. After writing the first byte to the start address, the register address will be incremented.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f\+\_\+start\+Register\+Addr\+\_\+ui8} & specifies the first register address to return \\
\hline
\mbox{\tt in}  & {\em f\+\_\+byte\+Stream\+To\+Write\+\_\+pui8} & points to an array of unsigned 8bit data elements (input byte stream buffer) \\
\hline
\mbox{\tt out}  & {\em returns} & a boolean value, indicating the occurrence of failures~\newline
 0 .... indicates success (no errors)~\newline
 1 .... indicates failed (some errors)\\
\hline
\end{DoxyParams}


Definition at line 207 of file acc\+Mag.\+c.


\begin{DoxyCode}
208 \{
209     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    l\_writeSucceeded\_bl     = \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL};   \textcolor{comment}{// success
       state as default}
210     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}   l\_bufCtr\_ui8            = 0;                        \textcolor{comment}{// loop counter to assemble payload
       and register address}
211     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}   l\_byteStreamBuffer\_rgXui8[
      \hyperlink{accMag_8h_aaa771727c176ae833aea7231c6bd80f0_aaa771727c176ae833aea7231c6bd80f0}{M\_HAL\_ACCMAG\_WRITE\_BYTESTREAM\_BUFFER\_SIZE\_UI8}];
212     \textcolor{comment}{/*}
213 \textcolor{comment}{     * - ensure at least one data byte to write}
214 \textcolor{comment}{     * - prevent a buffer overflow of l\_byteStreamBuffer\_rgXui8}
215 \textcolor{comment}{     *   --> payload data bytes + register address (subaddress)}
216 \textcolor{comment}{     */}
217     \textcolor{keywordflow}{if} (        (f\_numOfBytes\_ui32 < 1)
218             ||  (f\_numOfBytes\_ui32 > 
      \hyperlink{accMag_8h_aaa771727c176ae833aea7231c6bd80f0_aaa771727c176ae833aea7231c6bd80f0}{M\_HAL\_ACCMAG\_WRITE\_BYTESTREAM\_BUFFER\_SIZE\_UI8}-1) )
219     \{
220         \textcolor{keywordflow}{return} \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
221     \}
222 
223     \textcolor{comment}{/*}
224 \textcolor{comment}{     * prepare data to write (register + data)}
225 \textcolor{comment}{     * (1) ensure byte stream writing (MSB of register address shall be 1)}
226 \textcolor{comment}{     *     -> Mask MSB to one!}
227 \textcolor{comment}{     *     -> LSM303D will auto-increment the register address for each byte}
228 \textcolor{comment}{     *        of data}
229 \textcolor{comment}{     * (2) copy data to write to local buffer, start at second byte position}
230 \textcolor{comment}{     *     (first byte position is the register address)}
231 \textcolor{comment}{     */}
232     l\_byteStreamBuffer\_rgXui8[0] = f\_startRegisterAddr\_ui8 | 0b10000000;
233     \textcolor{keywordflow}{for}(l\_bufCtr\_ui8=0; l\_bufCtr\_ui8 < f\_numOfBytes\_ui32; l\_bufCtr\_ui8++)
234     \{
235         l\_byteStreamBuffer\_rgXui8[l\_bufCtr\_ui8+1] = f\_byteStreamToWrite\_pui8[l\_bufCtr\_ui8];
236     \}
237 
238     \textcolor{comment}{//write register to I2C}
239     \textcolor{keywordflow}{if} ( \hyperlink{LLD__I2C_8c_aa6892bf4aea7f232d9b0ff2dbf8a9321_aa6892bf4aea7f232d9b0ff2dbf8a9321}{g\_lldI2c\_WriteI2c\_bl}(\hyperlink{accMag_8h_a6c9acfcf0f8dff7a5789ddb4960b3599_a6c9acfcf0f8dff7a5789ddb4960b3599}{M\_HAL\_ACCMAG\_I2CADDR\_UI8}, 
      l\_byteStreamBuffer\_rgXui8, f\_numOfBytes\_ui32 + 1) != \hyperlink{accMag_8h_a244c94ee3b75087140235cf4f913623f_a244c94ee3b75087140235cf4f913623f}{M\_HAL\_ACCMAG\_SUCCESS\_BL} )
240     \{
241         \textcolor{comment}{// error in I2C access}
242         l\_writeSucceeded\_bl = \hyperlink{accMag_8h_a29da5c251bf0c3b1c7ed7da3c3269d9f_a29da5c251bf0c3b1c7ed7da3c3269d9f}{M\_HAL\_ACCMAG\_FAILED\_BL};
243     \}
244 
245     \textcolor{keywordflow}{return} l\_writeSucceeded\_bl;
246 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=344pt]{accMag_8c_af4a867d90abb126d82ba14ea2619f305_af4a867d90abb126d82ba14ea2619f305_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{accMag_8c_af4a867d90abb126d82ba14ea2619f305_af4a867d90abb126d82ba14ea2619f305_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}{\index{acc\+Mag.\+c@{acc\+Mag.\+c}!m\+\_\+hal\+Accmag\+\_\+sensor\+State\+\_\+st@{m\+\_\+hal\+Accmag\+\_\+sensor\+State\+\_\+st}}
\index{m\+\_\+hal\+Accmag\+\_\+sensor\+State\+\_\+st@{m\+\_\+hal\+Accmag\+\_\+sensor\+State\+\_\+st}!acc\+Mag.\+c@{acc\+Mag.\+c}}
\subsubsection[{m\+\_\+hal\+Accmag\+\_\+sensor\+State\+\_\+st}]{\setlength{\rightskip}{0pt plus 5cm}{\bf hal\+Accmag\+\_\+data\+Container} m\+\_\+hal\+Accmag\+\_\+sensor\+State\+\_\+st\hspace{0.3cm}{\ttfamily [static]}}}\label{accMag_8c_a421eb1956f3c2b98d7a4505bc13b049e_a421eb1956f3c2b98d7a4505bc13b049e}
acceleration state and compass state in one container 

Definition at line 12 of file acc\+Mag.\+c.

